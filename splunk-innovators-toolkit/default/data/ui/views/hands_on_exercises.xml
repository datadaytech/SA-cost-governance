<dashboard version="1.1" script="js/sit-toolkit.js" stylesheet="css/sit-theme.css,css/sit-components.css">
  <label>Hands-On Exercises</label>
  <description>Practice applying what you've learned by writing code and seeing it run</description>

  <row>
    <panel>
      <html>
        <style>
          .exercise-container {
            background: var(--sit-bg-medium);
            border: 1px solid var(--sit-border-color);
            border-radius: var(--sit-radius-lg);
            padding: 24px;
            margin-bottom: 24px;
          }
          .exercise-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
          }
          .exercise-number {
            background: var(--sit-primary);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
          }
          .exercise-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 0;
          }
          .exercise-description {
            color: var(--sit-text-secondary);
            margin-bottom: 16px;
            line-height: 1.6;
          }
          .exercise-task {
            background: var(--sit-info-bg);
            border: 1px solid var(--sit-info);
            border-radius: var(--sit-radius-md);
            padding: 16px;
            margin-bottom: 20px;
          }
          .exercise-task h4 {
            margin: 0 0 8px 0;
            color: var(--sit-info);
            font-size: 0.875rem;
            text-transform: uppercase;
          }
          .code-editor {
            width: 100%;
            min-height: 150px;
            padding: 16px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
            line-height: 1.5;
            background: #1e1e1e;
            color: #d4d4d4;
            border: 1px solid var(--sit-border-color);
            border-radius: var(--sit-radius-md);
            resize: vertical;
            tab-size: 2;
          }
          .code-editor:focus {
            outline: none;
            border-color: var(--sit-primary);
            box-shadow: 0 0 0 3px var(--sit-primary-light);
          }
          .output-area {
            border: 2px dashed var(--sit-border-color);
            border-radius: var(--sit-radius-md);
            padding: 24px;
            min-height: 100px;
            margin-top: 16px;
            background: var(--sit-bg-dark);
          }
          .output-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            color: var(--sit-text-muted);
            margin-bottom: 12px;
          }
          .button-row {
            display: flex;
            gap: 12px;
            margin-top: 12px;
          }
          .success-banner {
            background: var(--sit-success-bg);
            border: 1px solid var(--sit-success);
            border-radius: var(--sit-radius-md);
            padding: 12px 16px;
            margin-top: 16px;
            display: none;
            color: var(--sit-success);
            font-weight: 500;
          }
          .success-banner.show {
            display: flex;
            align-items: center;
            gap: 8px;
          }
          .error-banner {
            background: var(--sit-error-bg);
            border: 1px solid var(--sit-error);
            border-radius: var(--sit-radius-md);
            padding: 12px 16px;
            margin-top: 16px;
            display: none;
            color: var(--sit-error);
          }
          .error-banner.show {
            display: block;
          }
          .hint-section {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--sit-border-color);
          }
          .hint-toggle {
            font-size: 0.875rem;
            color: var(--sit-info);
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
            display: flex;
            align-items: center;
            gap: 6px;
          }
          .hint-toggle:hover {
            text-decoration: underline;
          }
          .hint-content {
            background: var(--sit-bg-dark);
            border-radius: var(--sit-radius-md);
            padding: 16px;
            margin-top: 12px;
            display: none;
            font-size: 0.875rem;
          }
          .hint-content.show {
            display: block;
          }
          .hint-content pre {
            background: #1e1e1e;
            padding: 12px;
            border-radius: var(--sit-radius-sm);
            overflow-x: auto;
            margin: 8px 0;
            color: #d4d4d4;
          }
          .intro-section {
            text-align: center;
            padding: 32px;
            margin-bottom: 32px;
          }
          .intro-section h2 {
            font-size: 1.75rem;
            margin-bottom: 12px;
          }
          .intro-section p {
            color: var(--sit-text-secondary);
            max-width: 700px;
            margin: 0 auto;
          }
          .reference-box {
            background: var(--sit-bg-dark);
            border-radius: var(--sit-radius-md);
            padding: 16px;
            margin-bottom: 16px;
            font-size: 0.875rem;
          }
          .reference-box h5 {
            margin: 0 0 8px 0;
            color: var(--sit-text-muted);
            text-transform: uppercase;
            font-size: 0.75rem;
          }
          .reference-box code {
            background: rgba(255,255,255,0.1);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.8rem;
          }
        </style>

        <div class="intro-section">
          <h2>Hands-On Exercises</h2>
          <p>Put your knowledge to the test! Write JavaScript code in the editors below and click "Run Code" to see your components come to life. Each exercise builds on what you learned in the demo.</p>
        </div>
      </html>
    </panel>
  </row>

  <!-- Exercise 1: Show a Toast Notification -->
  <row>
    <panel>
      <html>
        <div class="exercise-container">
          <div class="exercise-header">
            <div class="exercise-number">1</div>
            <h3 class="exercise-title">Show a Toast Notification</h3>
          </div>

          <p class="exercise-description">
            Toast notifications are great for giving users feedback. Your task is to write code that displays a success toast with a custom message.
          </p>

          <div class="exercise-task">
            <h4>Your Task</h4>
            <p>Write code to show a <strong>success</strong> toast notification with the title "Well Done!" and message "You completed your first exercise!"</p>
          </div>

          <div class="reference-box">
            <h5>Quick Reference</h5>
            <p>Use <code>toast.show({ type: '...', title: '...', message: '...' })</code></p>
            <p>Available types: <code>success</code>, <code>error</code>, <code>warning</code>, <code>info</code></p>
          </div>

          <label style="font-size: 0.875rem; color: var(--sit-text-secondary); display: block; margin-bottom: 8px;">Your Code:</label>
          <textarea class="code-editor" id="ex1-code" placeholder="// Write your code here...
// Example: toast.show({ type: 'info', title: 'Hello', message: 'World' });">toast.show({

});</textarea>

          <div class="button-row">
            <button class="sit-btn sit-btn-primary" id="ex1-run">Run Code</button>
            <button class="sit-btn sit-btn-secondary" id="ex1-reset">Reset</button>
          </div>

          <div class="success-banner" id="ex1-success">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
            </svg>
            Exercise Complete! You showed a success toast.
          </div>
          <div class="error-banner" id="ex1-error"></div>

          <div class="hint-section">
            <button class="hint-toggle" id="ex1-hint-toggle">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                <path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z"/>
              </svg>
              Need a hint?
            </button>
            <div class="hint-content" id="ex1-hint">
              <p><strong>Solution:</strong></p>
              <pre>toast.show({
  type: 'success',
  title: 'Well Done!',
  message: 'You completed your first exercise!'
});</pre>
            </div>
          </div>
        </div>
      </html>
    </panel>
  </row>

  <!-- Exercise 2: Open a Modal Dialog -->
  <row>
    <panel>
      <html>
        <div class="exercise-container">
          <div class="exercise-header">
            <div class="exercise-number">2</div>
            <h3 class="exercise-title">Open a Modal Dialog</h3>
          </div>

          <p class="exercise-description">
            Modals are useful for displaying important information or collecting user input. Your task is to create and open a modal with custom content.
          </p>

          <div class="exercise-task">
            <h4>Your Task</h4>
            <p>Create a modal with the title "Welcome!" and body content that says "This is my first modal." Then call <code>.open()</code> to display it.</p>
          </div>

          <div class="reference-box">
            <h5>Quick Reference</h5>
            <p>Create: <code>var modal = new SITModal({ title: '...', body: '...' })</code></p>
            <p>Open: <code>modal.open()</code></p>
            <p>Optional: <code>size: 'sm'</code>, <code>size: 'md'</code>, <code>size: 'lg'</code></p>
          </div>

          <label style="font-size: 0.875rem; color: var(--sit-text-secondary); display: block; margin-bottom: 8px;">Your Code:</label>
          <textarea class="code-editor" id="ex2-code" placeholder="// Create a modal and open it
var modal = new SITModal({

});
modal.open();">var modal = new SITModal({

});
modal.open();</textarea>

          <div class="button-row">
            <button class="sit-btn sit-btn-primary" id="ex2-run">Run Code</button>
            <button class="sit-btn sit-btn-secondary" id="ex2-reset">Reset</button>
          </div>

          <div class="success-banner" id="ex2-success">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
            </svg>
            Exercise Complete! Your modal appeared.
          </div>
          <div class="error-banner" id="ex2-error"></div>

          <div class="hint-section">
            <button class="hint-toggle" id="ex2-hint-toggle">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                <path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z"/>
              </svg>
              Need a hint?
            </button>
            <div class="hint-content" id="ex2-hint">
              <p><strong>Solution:</strong></p>
              <pre>var modal = new SITModal({
  title: 'Welcome!',
  body: 'This is my first modal.'
});
modal.open();</pre>
            </div>
          </div>
        </div>
      </html>
    </panel>
  </row>

  <!-- Exercise 3: Build Interactive Components -->
  <row>
    <panel>
      <html>
        <div class="exercise-container">
          <div class="exercise-header">
            <div class="exercise-number">3</div>
            <h3 class="exercise-title">Create an Interactive Confirmation</h3>
          </div>

          <p class="exercise-description">
            Combine what you've learned! Use the built-in confirm dialog to ask the user a question, then show a different toast based on their answer.
          </p>

          <div class="exercise-task">
            <h4>Your Task</h4>
            <p>Use <code>SITModal.confirm()</code> to ask "Do you like this toolkit?" - If they click OK, show a success toast saying "Thanks!". If they cancel, show an info toast saying "No problem!"</p>
          </div>

          <div class="reference-box">
            <h5>Quick Reference</h5>
            <p>Confirm dialog: <code>SITModal.confirm(message, onConfirm, onCancel)</code></p>
            <p>The <code>onConfirm</code> function runs when user clicks OK</p>
            <p>The <code>onCancel</code> function runs when user clicks Cancel</p>
          </div>

          <label style="font-size: 0.875rem; color: var(--sit-text-secondary); display: block; margin-bottom: 8px;">Your Code:</label>
          <textarea class="code-editor" id="ex3-code" placeholder="// Use SITModal.confirm() with callbacks
SITModal.confirm(
  'Your question here',
  function() {
    // This runs on OK
  },
  function() {
    // This runs on Cancel
  }
);">SITModal.confirm(
  '',
  function() {

  },
  function() {

  }
);</textarea>

          <div class="button-row">
            <button class="sit-btn sit-btn-primary" id="ex3-run">Run Code</button>
            <button class="sit-btn sit-btn-secondary" id="ex3-reset">Reset</button>
          </div>

          <div class="success-banner" id="ex3-success">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
            </svg>
            Exercise Complete! You handled both confirm and cancel actions.
          </div>
          <div class="error-banner" id="ex3-error"></div>

          <div class="hint-section">
            <button class="hint-toggle" id="ex3-hint-toggle">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                <path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z"/>
              </svg>
              Need a hint?
            </button>
            <div class="hint-content" id="ex3-hint">
              <p><strong>Solution:</strong></p>
              <pre>SITModal.confirm(
  'Do you like this toolkit?',
  function() {
    toast.show({
      type: 'success',
      title: 'Thanks!',
      message: 'We appreciate your feedback!'
    });
  },
  function() {
    toast.show({
      type: 'info',
      title: 'No problem!',
      message: 'Thanks for trying it out.'
    });
  }
);</pre>
            </div>
          </div>
        </div>
      </html>
    </panel>
  </row>

  <!-- Completion Section -->
  <row>
    <panel>
      <html>
        <div style="text-align: center; padding: 40px; background: var(--sit-bg-medium); border-radius: var(--sit-radius-lg); border: 1px solid var(--sit-border-color);">
          <div id="completion-status">
            <h3 style="margin-bottom: 12px;">Track Your Progress</h3>
            <p style="color: var(--sit-text-secondary); margin-bottom: 20px;">Complete all 3 exercises to master the basics!</p>
            <div style="display: flex; justify-content: center; gap: 16px;">
              <div id="progress-ex1" class="progress-badge" style="width: 80px; height: 80px; border-radius: 50%; border: 3px solid var(--sit-border-color); display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">1</div>
              <div id="progress-ex2" class="progress-badge" style="width: 80px; height: 80px; border-radius: 50%; border: 3px solid var(--sit-border-color); display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">2</div>
              <div id="progress-ex3" class="progress-badge" style="width: 80px; height: 80px; border-radius: 50%; border: 3px solid var(--sit-border-color); display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">3</div>
            </div>
          </div>
          <div id="all-complete" style="display: none;">
            <div style="font-size: 48px; margin-bottom: 16px;">ðŸŽ‰</div>
            <h3 style="margin-bottom: 12px; color: var(--sit-success);">All Exercises Complete!</h3>
            <p style="color: var(--sit-text-secondary);">You've mastered the basics of the Splunk Innovators Toolkit. Check out the Code Examples page for more advanced patterns!</p>
          </div>
        </div>

        <script>
          require([
            'jquery',
            'underscore',
            '/static/app/splunk-innovators-toolkit/components/sit-modal.js',
            '/static/app/splunk-innovators-toolkit/components/sit-toast.js'
          ], function($, _, SITModal, SITToast) {

            // Initialize toast system
            var toast = new SITToast();

            // Track completed exercises
            var completed = { ex1: false, ex2: false, ex3: false };

            function updateProgress() {
              Object.keys(completed).forEach(function(key) {
                var num = key.replace('ex', '');
                var $badge = $('#progress-ex' + num);
                if (completed[key]) {
                  $badge.css({
                    'border-color': 'var(--sit-success)',
                    'background': 'var(--sit-success)',
                    'color': 'white'
                  }).html('<svg width="32" height="32" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>');
                }
              });

              // Check if all complete
              if (completed.ex1 &amp;&amp; completed.ex2 &amp;&amp; completed.ex3) {
                $('#completion-status').hide();
                $('#all-complete').show();
              }
            }

            // Helper to safely execute user code
            function executeCode(code, context) {
              try {
                var fn = new Function('toast', 'SITModal', '_', '$', code);
                fn(toast, SITModal, _, $);
                return { success: true };
              } catch (e) {
                return { success: false, error: e.message };
              }
            }

            // Default code for each exercise
            var defaults = {
              ex1: 'toast.show({\n  \n});',
              ex2: 'var modal = new SITModal({\n  \n});\nmodal.open();',
              ex3: "SITModal.confirm(\n  '',\n  function() {\n    \n  },\n  function() {\n    \n  }\n);"
            };

            // ========================================
            // Exercise 1: Toast Notification
            // ========================================

            $('#ex1-hint-toggle').on('click', function() {
              $('#ex1-hint').toggleClass('show');
            });

            $('#ex1-reset').on('click', function() {
              $('#ex1-code').val(defaults.ex1);
              $('#ex1-success').removeClass('show');
              $('#ex1-error').removeClass('show');
            });

            $('#ex1-run').on('click', function() {
              var code = $('#ex1-code').val();
              $('#ex1-error').removeClass('show');

              var result = executeCode(code, { toast: toast });

              if (!result.success) {
                $('#ex1-error').text('Error: ' + result.error).addClass('show');
                return;
              }

              // Check if code contains success type
              if (code.includes("'success'") || code.includes('"success"')) {
                completed.ex1 = true;
                $('#ex1-success').addClass('show');
                updateProgress();
              }
            });

            // ========================================
            // Exercise 2: Modal Dialog
            // ========================================

            $('#ex2-hint-toggle').on('click', function() {
              $('#ex2-hint').toggleClass('show');
            });

            $('#ex2-reset').on('click', function() {
              $('#ex2-code').val(defaults.ex2);
              $('#ex2-success').removeClass('show');
              $('#ex2-error').removeClass('show');
            });

            $('#ex2-run').on('click', function() {
              var code = $('#ex2-code').val();
              $('#ex2-error').removeClass('show');

              var result = executeCode(code, { SITModal: SITModal });

              if (!result.success) {
                $('#ex2-error').text('Error: ' + result.error).addClass('show');
                return;
              }

              // Check if a modal was opened (look for .sit-modal-backdrop)
              setTimeout(function() {
                if ($('.sit-modal-backdrop').length > 0) {
                  completed.ex2 = true;
                  $('#ex2-success').addClass('show');
                  updateProgress();
                }
              }, 100);
            });

            // ========================================
            // Exercise 3: Confirm Dialog
            // ========================================

            var ex3ConfirmClicked = false;
            var ex3CancelClicked = false;

            $('#ex3-hint-toggle').on('click', function() {
              $('#ex3-hint').toggleClass('show');
            });

            $('#ex3-reset').on('click', function() {
              $('#ex3-code').val(defaults.ex3);
              $('#ex3-success').removeClass('show');
              $('#ex3-error').removeClass('show');
              ex3ConfirmClicked = false;
              ex3CancelClicked = false;
            });

            $('#ex3-run').on('click', function() {
              var code = $('#ex3-code').val();
              $('#ex3-error').removeClass('show');

              // Wrap the callbacks to track if they were called
              var wrappedCode = code.replace(
                /SITModal\.confirm\s*\(/,
                'window._ex3ConfirmCalled = false; window._ex3CancelCalled = false; SITModal.confirm('
              );

              var result = executeCode(code, { SITModal: SITModal, toast: toast });

              if (!result.success) {
                $('#ex3-error').text('Error: ' + result.error).addClass('show');
                return;
              }

              // Check if code has proper structure
              if (code.includes('SITModal.confirm') &amp;&amp;
                  code.includes('function()') &amp;&amp;
                  (code.includes('toast.show') || code.includes('toast.'))) {

                // Wait for user interaction with the confirm dialog
                var checkComplete = setInterval(function() {
                  if ($('.sit-modal-backdrop').length === 0) {
                    clearInterval(checkComplete);
                    completed.ex3 = true;
                    $('#ex3-success').addClass('show');
                    updateProgress();
                  }
                }, 500);

                // Timeout after 30 seconds
                setTimeout(function() {
                  clearInterval(checkComplete);
                }, 30000);
              }
            });

          });
        </script>
      </html>
    </panel>
  </row>

</dashboard>
