# =============================================================================
# 175 Scheduled Searches for SA-cost-governance App Testing
# =============================================================================
# Comprehensive test searches against _internal, _audit, _introspection
# Organized by category with varying runtimes and frequencies
# SPL sourced from Splunk best practices and community contributions
# =============================================================================

# =============================================================================
# SECTION 1: LICENSE & USAGE MONITORING (Searches 001-020)
# =============================================================================

[Governance_Test_001_License_Usage_Daily]
search = index=_internal source=*license_usage.log type=Usage | stats sum(b) as bytes by pool, idx | eval GB=round(bytes/1024/1024/1024,2) | sort -GB
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 6 * * *
enableSched = 1
description = Daily license usage by pool and index

[Governance_Test_002_License_Usage_By_Host]
search = index=_internal source=*license_usage.log type=Usage | stats sum(b) as bytes by h | eval MB=round(bytes/1024/1024,2) | sort -MB | head 50
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 7 * * *
enableSched = 1
description = License usage by host - top 50 consumers

[Governance_Test_003_License_Usage_By_Sourcetype]
search = index=_internal source=*license_usage.log type=Usage | stats sum(b) as bytes by st | eval MB=round(bytes/1024/1024,2) | sort -MB | head 100
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 8 * * *
enableSched = 1
description = License usage by sourcetype - top 100

[Governance_Test_004_License_Pool_Status]
search = index=_internal source=*license_usage.log type=RolloverSummary | stats latest(stacksz) as stack_size latest(peakUsage) as peak_usage by pool | eval pct_used=round(peak_usage/stack_size*100,2)
dispatch.earliest_time = -7d
dispatch.latest_time = now
cron_schedule = 0 9 * * *
enableSched = 1
description = License pool utilization status

[Governance_Test_005_License_Warning_Check]
search = index=_internal sourcetype=splunkd component=LicenseUsage "exceeded" OR "violation" OR "warning" | stats count by host, _time | where count > 0
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Check for license warnings or violations

[Governance_Test_006_License_Trend_Weekly]
search = index=_internal source=*license_usage.log type=Usage | timechart span=1d sum(b) as bytes | eval GB=round(bytes/1024/1024/1024,2)
dispatch.earliest_time = -30d
dispatch.latest_time = now
cron_schedule = 0 0 * * 0
enableSched = 1
description = Weekly license usage trend - 30 day view

[Governance_Test_007_License_Usage_Hourly]
search = index=_internal source=*license_usage.log type=Usage | bucket _time span=1h | stats sum(b) as bytes by _time | eval MB=round(bytes/1024/1024,2)
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 30 * * * *
enableSched = 1
description = Hourly license consumption pattern

[Governance_Test_008_License_Slave_Status]
search = index=_internal sourcetype=splunkd component=LicenseMaster | stats count by slave, status | where status!="OK"
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 * * * *
enableSched = 1
description = License slave status check

[Governance_Test_009_Index_License_Distribution]
search = index=_internal source=*license_usage.log type=Usage | stats sum(b) as bytes by idx | eventstats sum(bytes) as total | eval pct=round(bytes/total*100,2) | sort -pct | head 25
dispatch.earliest_time = -7d
dispatch.latest_time = now
cron_schedule = 0 5 * * 1
enableSched = 1
description = Index contribution to license - weekly

[Governance_Test_010_License_Anomaly_Detection]
search = index=_internal source=*license_usage.log type=Usage | timechart span=1h sum(b) as bytes | streamstats window=24 avg(bytes) as baseline stdev(bytes) as stddev | eval anomaly=if(bytes > baseline + 2*stddev, 1, 0) | where anomaly=1
dispatch.earliest_time = -7d
dispatch.latest_time = now
cron_schedule = 0 10 * * *
enableSched = 1
description = Detect license usage anomalies

[Governance_Test_011_License_By_Source]
search = index=_internal source=*license_usage.log type=Usage | stats sum(b) as bytes by s | eval MB=round(bytes/1024/1024,2) | sort -MB | head 100
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 11 * * *
enableSched = 1
description = License usage by source path

[Governance_Test_012_License_Peak_Hours]
search = index=_internal source=*license_usage.log type=Usage | eval hour=strftime(_time, "%H") | stats sum(b) as bytes by hour | eval GB=round(bytes/1024/1024/1024,2) | sort hour
dispatch.earliest_time = -7d
dispatch.latest_time = now
cron_schedule = 0 12 * * *
enableSched = 1
description = License usage by hour of day

[Governance_Test_013_License_Growth_Rate]
search = index=_internal source=*license_usage.log type=Usage | timechart span=1d sum(b) as bytes | streamstats current=f window=1 last(bytes) as prev_bytes | eval growth_pct=round((bytes-prev_bytes)/prev_bytes*100,2)
dispatch.earliest_time = -30d
dispatch.latest_time = now
cron_schedule = 0 13 * * *
enableSched = 1
description = Daily license growth rate

[Governance_Test_014_License_Forwarder_Contribution]
search = index=_internal source=*license_usage.log type=Usage | stats sum(b) as bytes by h | lookup dnslookup clientip as h OUTPUT clienthost as hostname | stats sum(bytes) as total_bytes by hostname | sort -total_bytes | head 50
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 14 * * *
enableSched = 1
description = License by forwarder hostname

[Governance_Test_015_License_Quota_Check]
search = index=_internal source=*license_usage.log type=Usage | stats sum(b) as used | appendcols [| rest /services/licenser/pools | stats sum(quota) as quota] | eval pct_used=round(used/quota*100,2)
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = License quota utilization check

[Governance_Test_016_License_Violation_History]
search = index=_internal sourcetype=splunkd component=LicenseUsage "violation" | timechart span=1d count by pool
dispatch.earliest_time = -90d
dispatch.latest_time = now
cron_schedule = 0 0 * * 1
enableSched = 1
description = Historical license violations

[Governance_Test_017_License_By_Index_Hourly]
search = index=_internal source=*license_usage.log type=Usage | timechart span=1h sum(b) as bytes by idx limit=20
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Hourly license by index trend

[Governance_Test_018_License_Efficiency_Score]
search = index=_internal source=*license_usage.log type=Usage | stats sum(b) as bytes dc(h) as hosts dc(st) as sourcetypes by idx | eval efficiency=round(bytes/(hosts*sourcetypes),2) | sort -efficiency
dispatch.earliest_time = -7d
dispatch.latest_time = now
cron_schedule = 0 15 * * *
enableSched = 1
description = License efficiency by index

[Governance_Test_019_License_Sparse_Data]
search = index=_internal source=*license_usage.log type=Usage | stats sum(b) as bytes count by idx | eval bytes_per_event=round(bytes/count,2) | where bytes_per_event > 10000 | sort -bytes_per_event
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 16 * * *
enableSched = 1
description = Indexes with sparse data patterns

[Governance_Test_020_License_Master_Status]
search = index=_internal sourcetype=splunkd component=LicenseMaster | stats latest(status) as status latest(quota) as quota by pool | eval quota_GB=round(quota/1024/1024/1024,2)
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = */30 * * * *
enableSched = 1
description = License master pool status

# =============================================================================
# SECTION 2: INDEX & DATA HEALTH (Searches 021-045)
# =============================================================================

[Governance_Test_021_Index_Throughput]
search = index=_internal sourcetype=splunkd component=Metrics group=per_index_thruput | stats avg(eps) as avg_eps max(eps) as max_eps sum(kb) as total_kb by series | sort -avg_eps
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 15 * * * *
enableSched = 1
description = Index throughput metrics - hourly

[Governance_Test_022_Sourcetype_Throughput]
search = index=_internal sourcetype=splunkd component=Metrics group=per_sourcetype_thruput | stats avg(eps) as avg_eps sum(kb) as total_kb by series | sort -total_kb | head 50
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 20 * * * *
enableSched = 1
description = Sourcetype throughput - top 50

[Governance_Test_023_Index_Event_Count]
search = | tstats count where index=* by index | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 3 * * *
enableSched = 1
description = Event count by index - daily

[Governance_Test_024_Data_Latency_Check]
search = index=_internal sourcetype=splunkd component=Metrics group=per_index_thruput | eval latency=_indextime-_time | stats avg(latency) as avg_latency max(latency) as max_latency by series | where avg_latency > 60
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = */30 * * * *
enableSched = 1
description = Check for data indexing latency issues

[Governance_Test_025_Bucket_Status]
search = | dbinspect index=* | stats count sum(sizeOnDiskMB) as total_size_mb dc(bucketId) as bucket_count by index, state | sort -total_size_mb
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 4 * * *
enableSched = 1
description = Bucket status and size by index

[Governance_Test_026_Hot_Bucket_Monitor]
search = | dbinspect index=* | where state="hot" | stats count sum(sizeOnDiskMB) as hot_size_mb by index | sort -hot_size_mb
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Monitor hot bucket sizes

[Governance_Test_027_Index_Volume_Growth]
search = | rest /services/data/indexes | table title totalEventCount currentDBSizeMB maxDataSizeMB | eval pct_used=round(currentDBSizeMB/maxDataSizeMB*100,2) | sort -pct_used
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Index volume utilization

[Governance_Test_028_Data_Model_Acceleration_Status]
search = | rest /services/admin/summarization by_tstats=t | table datamodel_acceleration.label datamodel_acceleration.complete_pct eai:acl.app | sort -datamodel_acceleration.complete_pct
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Data model acceleration status

[Governance_Test_029_Parsing_Errors]
search = index=_internal sourcetype=splunkd component=LineBreakingProcessor OR component=DateParser "ERROR" OR "WARN" | stats count by component, host | where count > 100
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Check for parsing errors

[Governance_Test_030_Index_Retention_Check]
search = | rest /services/data/indexes | table title frozenTimePeriodInSecs maxTotalDataSizeMB coldPath.maxDataSizeMB | eval retention_days=frozenTimePeriodInSecs/86400 | sort -retention_days
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 6 * * 1
enableSched = 1
description = Weekly index retention policy review

[Governance_Test_031_Sourcetype_Event_Distribution]
search = | tstats count where index=* by sourcetype, index | sort -count | head 100
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 5 * * *
enableSched = 1
description = Event distribution by sourcetype

[Governance_Test_032_Index_Span_Analysis]
search = | tstats earliest(_time) as earliest latest(_time) as latest where index=* by index | eval span_days=round((latest-earliest)/86400,1)
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 6 * * *
enableSched = 1
description = Time span of data in each index

[Governance_Test_033_Warm_Bucket_Analysis]
search = | dbinspect index=* | where state="warm" | stats count sum(sizeOnDiskMB) as size_mb avg(sizeOnDiskMB) as avg_size by index | sort -size_mb
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Warm bucket analysis by index

[Governance_Test_034_Cold_Bucket_Analysis]
search = | dbinspect index=* | where state="cold" | stats count sum(sizeOnDiskMB) as size_mb by index | sort -size_mb
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Cold bucket analysis by index

[Governance_Test_035_Bucket_Rollover_Rate]
search = index=_internal sourcetype=splunkd component=HotBucketRoller | timechart span=1h count by index limit=20
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Bucket rollover frequency

[Governance_Test_036_Index_Replication_Status]
search = index=_internal sourcetype=splunkd component=CMBucketReplicator | stats count by action, status | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Index replication status

[Governance_Test_037_Timestamp_Extraction_Issues]
search = index=_internal sourcetype=splunkd component=DateParser "failed" OR "unable" | stats count by host, source | where count > 50
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Timestamp extraction failures

[Governance_Test_038_Event_Truncation_Monitor]
search = index=_internal sourcetype=splunkd component=LineBreakingProcessor "truncat" | stats count by host, source | where count > 10
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Event truncation monitoring

[Governance_Test_039_Index_Bloom_Filter_Usage]
search = index=_internal sourcetype=splunkd component=Bloomfilter | stats count by action, status | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 7 * * *
enableSched = 1
description = Bloom filter usage statistics

[Governance_Test_040_TSIDX_Disk_Usage]
search = | dbinspect index=* | stats sum(rawSize) as raw_bytes sum(sizeOnDiskMB) as disk_mb by index | eval compression_ratio=round(raw_bytes/1024/1024/disk_mb,2) | sort -disk_mb
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 8 * * *
enableSched = 1
description = TSIDX compression ratios

[Governance_Test_041_Index_Time_Lag]
search = index=_internal sourcetype=splunkd component=Metrics group=per_index_thruput | eval lag=_indextime-_time | timechart span=5m avg(lag) as avg_lag by series limit=10
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Index time lag trend

[Governance_Test_042_Sourcetype_Cardinality]
search = | tstats dc(host) as hosts dc(source) as sources count where index=* by sourcetype | sort -count | head 50
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 9 * * *
enableSched = 1
description = Sourcetype cardinality analysis

[Governance_Test_043_Index_Event_Size]
search = index=_internal sourcetype=splunkd component=Metrics group=per_index_thruput | eval event_size=kb*1024/ev | stats avg(event_size) as avg_event_size by series | sort -avg_event_size
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 10 * * *
enableSched = 1
description = Average event size by index

[Governance_Test_044_Data_Integrity_Check]
search = index=_internal sourcetype=splunkd "integrity" OR "corrupt" OR "checksum" | stats count by host, log_level | where log_level="ERROR" OR log_level="WARN"
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Data integrity issues

[Governance_Test_045_Index_Metadata_Stats]
search = | rest /services/data/indexes | stats count sum(currentDBSizeMB) as total_size_mb avg(currentDBSizeMB) as avg_size_mb by datatype
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 11 * * *
enableSched = 1
description = Index metadata statistics

# =============================================================================
# SECTION 3: SEARCH & SCHEDULER PERFORMANCE (Searches 046-085)
# =============================================================================

[Governance_Test_046_Search_Performance_Summary]
search = index=_audit action=search info=completed | stats count avg(total_run_time) as avg_runtime max(total_run_time) as max_runtime sum(total_run_time) as total_runtime by user | sort -total_runtime | head 25
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 7 * * *
enableSched = 1
description = Daily search performance by user

[Governance_Test_047_Long_Running_Searches]
search = index=_audit action=search info=completed total_run_time>300 | table _time user search total_run_time result_count | sort -total_run_time | head 50
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 8 * * *
enableSched = 1
description = Searches running over 5 minutes

[Governance_Test_048_Failed_Searches]
search = index=_audit action=search info=failed OR info=cancelled | stats count by user, info, search_id | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 9 * * *
enableSched = 1
description = Failed and cancelled searches

[Governance_Test_049_Scheduler_Status]
search = index=_internal sourcetype=scheduler status=* | stats count by status, savedsearch_name | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Scheduler job status summary

[Governance_Test_050_Skipped_Searches]
search = index=_internal sourcetype=scheduler status=skipped | stats count by savedsearch_name, reason | sort -count | head 25
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 10 * * *
enableSched = 1
description = Skipped scheduled searches

[Governance_Test_051_Scheduler_Lag]
search = index=_internal sourcetype=scheduler | eval lag=dispatch_time-scheduled_time | stats avg(lag) as avg_lag max(lag) as max_lag by savedsearch_name | where avg_lag > 60 | sort -avg_lag
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 11 * * *
enableSched = 1
description = Scheduler lag analysis

[Governance_Test_052_Search_Concurrency]
search = index=_introspection sourcetype=splunk_resource_usage component=PerProcess data.search_props.sid=* | timechart span=5m dc(data.search_props.sid) as concurrent_searches
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Search concurrency over time

[Governance_Test_053_Search_Memory_Usage]
search = index=_introspection sourcetype=splunk_resource_usage component=PerProcess data.search_props.sid=* | stats avg(data.mem_used) as avg_mem max(data.mem_used) as max_mem by data.search_props.sid | sort -max_mem | head 25
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Search memory consumption

[Governance_Test_054_Expensive_Commands]
search = index=_audit action=search info=completed | rex field=search "\\|\\s*(?<command>\\w+)" | stats count sum(total_run_time) as total_time by command | sort -total_time | head 20
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 12 * * *
enableSched = 1
description = Most time-consuming search commands

[Governance_Test_055_Search_Head_CPU]
search = index=_introspection sourcetype=splunk_resource_usage component=Hostwide | timechart span=5m avg(data.cpu_user_pct) as user_cpu avg(data.cpu_system_pct) as system_cpu by host
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = */15 * * * *
enableSched = 1
description = Search head CPU utilization

[Governance_Test_056_Dispatch_Directory_Size]
search = index=_internal sourcetype=splunkd component=DispatchManager | stats latest(active_jobs) as active max(active_jobs) as peak by host
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Dispatch directory job count

[Governance_Test_057_Realtime_Search_Monitor]
search = index=_audit action=search info=granted search_type=realtime | stats count by user, search | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Monitor realtime searches

[Governance_Test_058_Ad_Hoc_vs_Scheduled]
search = index=_audit action=search info=completed | eval search_type=if(isnull(savedsearch_name),"ad-hoc","scheduled") | stats count avg(total_run_time) as avg_runtime by search_type
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 13 * * *
enableSched = 1
description = Compare ad-hoc vs scheduled search load

[Governance_Test_059_Search_Quota_Usage]
search = index=_audit action=search info=completed | stats count sum(total_run_time) as total_runtime by user | eventstats sum(total_runtime) as grand_total | eval pct_of_total=round(total_runtime/grand_total*100,2) | sort -pct_of_total | head 20
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 14 * * *
enableSched = 1
description = User search quota consumption

[Governance_Test_060_Saved_Search_Inventory]
search = | rest /services/saved/searches | stats count by eai:acl.app, is_scheduled, disabled | sort -count
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 0 * * 1
enableSched = 1
description = Weekly saved search inventory

[Governance_Test_061_Search_Bundle_Replication]
search = index=_internal sourcetype=splunkd component=DistributedSearch "bundle" | stats count by action, status | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Search bundle replication status

[Governance_Test_062_Search_Peer_Status]
search = | rest /services/search/distributed/peers | table peerName status replicationStatus searchable_indexes | sort peerName
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = */15 * * * *
enableSched = 1
description = Distributed search peer status

[Governance_Test_063_Search_Timeline]
search = index=_audit action=search info=completed | timechart span=1h count by user limit=10
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Search activity timeline by user

[Governance_Test_064_Search_Result_Count]
search = index=_audit action=search info=completed | stats avg(result_count) as avg_results max(result_count) as max_results sum(result_count) as total_results by user | sort -total_results | head 25
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 15 * * *
enableSched = 1
description = Search result count analysis

[Governance_Test_065_Export_Job_Monitor]
search = index=_audit action=search info=completed export_type=* | stats count sum(result_count) as total_exported by user, export_type | sort -total_exported
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 16 * * *
enableSched = 1
description = Data export job monitoring

[Governance_Test_066_Search_Priority_Analysis]
search = index=_internal sourcetype=scheduler | stats count avg(run_time) as avg_runtime by priority | sort priority
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 17 * * *
enableSched = 1
description = Search performance by priority

[Governance_Test_067_Subsearch_Usage]
search = index=_audit action=search info=completed search="*[search*" | stats count avg(total_run_time) as avg_runtime by user | sort -avg_runtime
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 18 * * *
enableSched = 1
description = Subsearch usage patterns

[Governance_Test_068_Join_Command_Analysis]
search = index=_audit action=search info=completed search="*| join*" | stats count avg(total_run_time) as avg_runtime by user | sort -avg_runtime
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 19 * * *
enableSched = 1
description = Join command usage analysis

[Governance_Test_069_Transaction_Command_Usage]
search = index=_audit action=search info=completed search="*| transaction*" | stats count avg(total_run_time) as avg_runtime by user | sort -avg_runtime
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 20 * * *
enableSched = 1
description = Transaction command usage

[Governance_Test_070_Eval_Complexity_Analysis]
search = index=_audit action=search info=completed | rex field=search max_match=0 "\\|\\s*eval" | eval eval_count=mvcount(eval) | where eval_count > 5 | stats count avg(total_run_time) as avg_runtime by user | sort -avg_runtime
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 21 * * *
enableSched = 1
description = Complex eval usage analysis

[Governance_Test_071_Accelerated_Report_Usage]
search = index=_audit action=search info=completed provenance=* | stats count by provenance | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 22 * * *
enableSched = 1
description = Accelerated report usage

[Governance_Test_072_Search_App_Distribution]
search = index=_audit action=search info=completed | stats count sum(total_run_time) as total_time by app | sort -total_time
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 23 * * *
enableSched = 1
description = Search load by app

[Governance_Test_073_Search_Role_Analysis]
search = index=_audit action=search info=completed | stats count avg(total_run_time) as avg_runtime by roles | mvexpand roles | stats sum(count) as searches sum(avg_runtime) as total_runtime by roles | sort -searches
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 1 * * *
enableSched = 1
description = Search activity by role

[Governance_Test_074_Lookup_Command_Usage]
search = index=_audit action=search info=completed search="*| lookup*" | stats count avg(total_run_time) as avg_runtime by user | sort -count | head 25
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 2 * * *
enableSched = 1
description = Lookup command usage patterns

[Governance_Test_075_Inputlookup_Analysis]
search = index=_audit action=search info=completed search="*| inputlookup*" | rex field=search "inputlookup\\s+(?<lookup_name>\\w+)" | stats count by lookup_name | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 3 * * *
enableSched = 1
description = Inputlookup usage by lookup name

[Governance_Test_076_Search_Scan_Count]
search = index=_audit action=search info=completed | stats avg(scan_count) as avg_scanned max(scan_count) as max_scanned by user | where avg_scanned > 1000000 | sort -avg_scanned
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 4 * * *
enableSched = 1
description = High scan count searches

[Governance_Test_077_Saved_Search_Runtime_History]
search = index=_internal sourcetype=scheduler | timechart span=1h avg(run_time) as avg_runtime by savedsearch_name limit=15
dispatch.earliest_time = -7d
dispatch.latest_time = now
cron_schedule = 0 5 * * *
enableSched = 1
description = Saved search runtime trend

[Governance_Test_078_Search_Error_Analysis]
search = index=_audit action=search info=failed | rex field=search_error "(?<error_type>[A-Z][a-z]+Error)" | stats count by error_type | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Search error classification

[Governance_Test_079_Dispatch_TTL_Analysis]
search = | rest /services/saved/searches | where is_scheduled=1 | table title dispatch.ttl cron_schedule | sort dispatch.ttl
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 6 * * 1
enableSched = 1
description = Dispatch TTL configuration review

[Governance_Test_080_Search_Head_Pooling]
search = index=_internal sourcetype=splunkd component=SearchHeadPooling | stats count by action, status | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Search head pooling activity

[Governance_Test_081_Remote_Search_Time]
search = index=_audit action=search info=completed | eval remote_time=total_run_time-exec_time | stats avg(remote_time) as avg_remote avg(exec_time) as avg_local by user | where avg_remote > avg_local | sort -avg_remote
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 7 * * *
enableSched = 1
description = Remote vs local search time

[Governance_Test_082_Search_Artifact_Size]
search = index=_audit action=search info=completed | stats avg(result_count) as avg_results sum(result_count) as total_results count by savedsearch_name | where isnotnull(savedsearch_name) | sort -total_results | head 25
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 8 * * *
enableSched = 1
description = Search artifact size by saved search

[Governance_Test_083_Map_Command_Usage]
search = index=_audit action=search info=completed search="*| map*" | stats count avg(total_run_time) as avg_runtime by user | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 9 * * *
enableSched = 1
description = Map command usage patterns

[Governance_Test_084_REST_Command_Usage]
search = index=_audit action=search info=completed search="*| rest*" | stats count avg(total_run_time) as avg_runtime by user | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 10 * * *
enableSched = 1
description = REST command in searches

[Governance_Test_085_Tstats_Usage_Analysis]
search = index=_audit action=search info=completed search="*| tstats*" | stats count avg(total_run_time) as avg_runtime by user | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 11 * * *
enableSched = 1
description = Tstats command usage efficiency

# =============================================================================
# SECTION 4: SECURITY & AUTHENTICATION (Searches 086-110)
# =============================================================================

[Governance_Test_086_Login_Activity]
search = index=_audit action=login | stats count by user, info | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 6 * * *
enableSched = 1
description = Daily login activity summary

[Governance_Test_087_Failed_Logins]
search = index=_audit action=login info=failed | stats count by user, src | where count > 3 | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Failed login attempts

[Governance_Test_088_User_Role_Changes]
search = index=_audit action=edit_user OR action=edit_roles | table _time user object info | sort -_time
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 7 * * *
enableSched = 1
description = User and role modifications

[Governance_Test_089_Password_Changes]
search = index=_audit action=change_password | stats count by user, info | sort -_time
dispatch.earliest_time = -7d
dispatch.latest_time = now
cron_schedule = 0 8 * * 1
enableSched = 1
description = Weekly password change audit

[Governance_Test_090_REST_API_Access]
search = index=_internal sourcetype=splunkd_access method=* uri_path=*/servicesNS/* | stats count by method, uri_path, user | sort -count | head 50
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 9 * * *
enableSched = 1
description = REST API access patterns

[Governance_Test_091_Token_Authentication]
search = index=_audit action=login info=*token* | stats count by user, info | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 10 * * *
enableSched = 1
description = Token-based authentication activity

[Governance_Test_092_Admin_Actions]
search = index=_audit user=admin OR user=sc_admin | stats count by action, object | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 11 * * *
enableSched = 1
description = Admin user activity audit

[Governance_Test_093_Permission_Changes]
search = index=_audit action=edit_* info=*permission* OR action=*acl* | table _time user action object info | sort -_time
dispatch.earliest_time = -7d
dispatch.latest_time = now
cron_schedule = 0 12 * * *
enableSched = 1
description = Permission and ACL changes

[Governance_Test_094_Session_Duration]
search = index=_audit action=login OR action=logout | transaction user startswith=action="login" endswith=action="logout" | stats avg(duration) as avg_session max(duration) as max_session by user
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 13 * * *
enableSched = 1
description = User session duration analysis

[Governance_Test_095_Capability_Usage]
search = index=_audit action=capability | stats count by user, info | sort -count | head 25
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 14 * * *
enableSched = 1
description = Capability usage audit

[Governance_Test_096_SAML_Authentication]
search = index=_audit action=login info=*SAML* | stats count by user, info | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 15 * * *
enableSched = 1
description = SAML authentication activity

[Governance_Test_097_LDAP_Authentication]
search = index=_audit action=login info=*LDAP* | stats count by user, info | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 16 * * *
enableSched = 1
description = LDAP authentication activity

[Governance_Test_098_Login_Location_Analysis]
search = index=_audit action=login info=success | iplocation src | stats count by user, Country, City | sort -count
dispatch.earliest_time = -7d
dispatch.latest_time = now
cron_schedule = 0 17 * * *
enableSched = 1
description = Login location analysis

[Governance_Test_099_Concurrent_Sessions]
search = index=_audit action=login info=success | timechart span=1h dc(user) as active_users
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Concurrent user sessions

[Governance_Test_100_After_Hours_Access]
search = index=_audit action=login info=success | eval hour=strftime(_time, "%H") | where hour < 6 OR hour > 22 | stats count by user, hour | sort -count
dispatch.earliest_time = -7d
dispatch.latest_time = now
cron_schedule = 0 18 * * *
enableSched = 1
description = After hours login activity

[Governance_Test_101_App_Installation_Audit]
search = index=_audit action=install_app OR action=update_app | table _time user action object info | sort -_time
dispatch.earliest_time = -30d
dispatch.latest_time = now
cron_schedule = 0 0 * * 1
enableSched = 1
description = App installation audit

[Governance_Test_102_Configuration_Changes]
search = index=_audit action=edit_* | stats count by action, object | sort -count | head 50
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 19 * * *
enableSched = 1
description = Configuration change summary

[Governance_Test_103_Index_Access_Patterns]
search = index=_audit action=search info=completed | rex field=search "index=(?<searched_index>\\w+)" | stats count by user, searched_index | sort -count | head 100
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 20 * * *
enableSched = 1
description = User index access patterns

[Governance_Test_104_Sensitive_Data_Access]
search = index=_audit action=search info=completed search="*password*" OR search="*secret*" OR search="*credential*" | stats count by user | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 21 * * *
enableSched = 1
description = Sensitive data search patterns

[Governance_Test_105_User_Creation_Audit]
search = index=_audit action=create_user | table _time user object info | sort -_time
dispatch.earliest_time = -30d
dispatch.latest_time = now
cron_schedule = 0 22 * * *
enableSched = 1
description = User creation audit

[Governance_Test_106_Role_Assignment_Changes]
search = index=_audit action=edit_roles | rex field=info "roles=(?<assigned_roles>[^,]+)" | stats count by user, object, assigned_roles | sort -_time
dispatch.earliest_time = -7d
dispatch.latest_time = now
cron_schedule = 0 23 * * *
enableSched = 1
description = Role assignment changes

[Governance_Test_107_Token_Creation_Audit]
search = index=_audit action=create_token | table _time user object info | sort -_time
dispatch.earliest_time = -30d
dispatch.latest_time = now
cron_schedule = 0 1 * * *
enableSched = 1
description = Token creation audit

[Governance_Test_108_Inactive_User_Logins]
search = index=_audit action=login info=success | stats latest(_time) as last_login by user | eval days_since=round((now()-last_login)/86400,0) | where days_since > 30 | sort -days_since
dispatch.earliest_time = -90d
dispatch.latest_time = now
cron_schedule = 0 2 * * 1
enableSched = 1
description = Inactive user login analysis

[Governance_Test_109_Brute_Force_Detection]
search = index=_audit action=login info=failed | bucket _time span=5m | stats count by user, _time | where count > 5 | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = */30 * * * *
enableSched = 1
description = Potential brute force attempts

[Governance_Test_110_Service_Account_Activity]
search = index=_audit action=login user=svc_* OR user=service_* | stats count by user, info | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 3 * * *
enableSched = 1
description = Service account activity

# =============================================================================
# SECTION 5: FORWARDER & INFRASTRUCTURE (Searches 111-135)
# =============================================================================

[Governance_Test_111_Forwarder_Connections]
search = index=_internal sourcetype=splunkd component=Metrics group=tcpin_connections | stats dc(hostname) as total_forwarders sum(kb) as total_kb by host | sort -total_kb
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 * * * *
enableSched = 1
description = Hourly forwarder connection summary

[Governance_Test_112_Missing_Forwarders]
search = index=_internal sourcetype=splunkd component=Metrics group=tcpin_connections | stats latest(_time) as last_seen by hostname | eval hours_ago=round((now()-last_seen)/3600,1) | where hours_ago > 1 | sort -hours_ago
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = */30 * * * *
enableSched = 1
description = Detect silent/missing forwarders

[Governance_Test_113_Forwarder_Data_Volume]
search = index=_internal sourcetype=splunkd component=Metrics group=tcpin_connections | timechart span=1h sum(kb) as kb by hostname limit=20
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Forwarder data volume trend

[Governance_Test_114_Deployment_Server_Status]
search = index=_internal sourcetype=splunkd component=DC* OR component=DeploymentClient | stats count by host, component, log_level | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Deployment client status

[Governance_Test_115_Indexer_Cluster_Status]
search = | rest /services/cluster/master/peers | table label status replication_port_configured is_searchable | sort label
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = */15 * * * *
enableSched = 1
description = Indexer cluster peer status

[Governance_Test_116_SHC_Member_Status]
search = | rest /services/shcluster/member/members | table label status adhoc_searchhead is_captain | sort -is_captain
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = */15 * * * *
enableSched = 1
description = Search head cluster member status

[Governance_Test_117_Replication_Factor_Check]
search = index=_internal sourcetype=splunkd component=CM* "replication factor" OR "search factor" | stats count by log_level, message | where log_level="WARN" OR log_level="ERROR"
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Check replication factor issues

[Governance_Test_118_HEC_Token_Usage]
search = index=_internal sourcetype=splunkd component=HttpInputDataHandler | stats count sum(bytes_received) as total_bytes by token_name | sort -total_bytes
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = HEC token usage statistics

[Governance_Test_119_SSL_Certificate_Check]
search = index=_internal sourcetype=splunkd "certificate" "expir" OR "SSL" "error" | stats count by host, log_level | where log_level="WARN" OR log_level="ERROR"
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 6 * * *
enableSched = 1
description = SSL/TLS certificate issues

[Governance_Test_120_Splunk_Version_Inventory]
search = index=_internal sourcetype=splunkd component=loader "build" | rex "build\\s+(?<build>\\d+)" | stats latest(build) by host | sort host
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 0 * * 1
enableSched = 1
description = Weekly Splunk version inventory

[Governance_Test_121_Forwarder_Queue_Status]
search = index=_internal sourcetype=splunkd component=Metrics group=queue host=*fwd* | stats avg(current_size_kb) as avg_size max(current_size_kb) as max_size by name, host | where max_size > 500
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Forwarder queue health

[Governance_Test_122_TCP_Output_Status]
search = index=_internal sourcetype=splunkd component=TcpOutputProc | stats count by action, status | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = TCP output connection status

[Governance_Test_123_Forwarder_CPU_Usage]
search = index=_internal sourcetype=splunkd component=Metrics group=pipeline | stats avg(cpu_seconds) as avg_cpu by name, host | sort -avg_cpu | head 25
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Forwarder CPU consumption

[Governance_Test_124_Deployment_App_Status]
search = | rest /services/deployment/server/applications | table name serverclasses restartSplunkd | sort name
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Deployment server app inventory

[Governance_Test_125_Indexer_Pipeline_Status]
search = index=_internal sourcetype=splunkd component=Metrics group=pipeline | stats avg(exec_time) as avg_exec_time by processor, host | sort -avg_exec_time
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Indexer pipeline performance

[Governance_Test_126_Cluster_Bundle_Status]
search = | rest /services/cluster/master/info | table active_bundle latest_bundle
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = */30 * * * *
enableSched = 1
description = Cluster bundle deployment status

[Governance_Test_127_SHC_Artifact_Replication]
search = index=_internal sourcetype=splunkd component=SHCConfig | stats count by action, status | where status!="success"
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = SHC artifact replication issues

[Governance_Test_128_Heavy_Forwarder_Load]
search = index=_internal sourcetype=splunkd host=*hf* component=Metrics group=per_host_thruput | stats sum(kb) as total_kb by host | sort -total_kb
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Heavy forwarder throughput

[Governance_Test_129_Universal_Forwarder_Errors]
search = index=_internal sourcetype=splunkd host=*uf* log_level=ERROR | stats count by host, component | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Universal forwarder errors

[Governance_Test_130_Introspection_Data_Volume]
search = index=_introspection | stats count sum(bytes) as total_bytes by sourcetype | sort -total_bytes
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 7 * * *
enableSched = 1
description = Introspection data volume

[Governance_Test_131_Cluster_Peer_Bucket_Count]
search = | rest /services/cluster/master/peers | table label bucket_count primary_count | sort -bucket_count
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Cluster peer bucket distribution

[Governance_Test_132_Fixup_Tasks]
search = index=_internal sourcetype=splunkd component=CMBucketFixupThread | stats count by action, reason | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Cluster fixup task analysis

[Governance_Test_133_Smartstore_Status]
search = index=_internal sourcetype=splunkd component=CacheManager | stats count by action, status | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = SmartStore cache manager status

[Governance_Test_134_S2S_Connection_Health]
search = index=_internal sourcetype=splunkd component=TcpInputProc fwd_type=* | stats dc(guid) as forwarders sum(tcp_eps) as total_eps by host | sort -total_eps
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = 0 * * * *
enableSched = 1
description = S2S connection health

[Governance_Test_135_Cluster_Generation_Status]
search = index=_internal sourcetype=splunkd component=CMMetrics | stats latest(generation_id) as gen_id by host
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = */15 * * * *
enableSched = 1
description = Cluster generation status

# =============================================================================
# SECTION 6: ERROR & ALERT MONITORING (Searches 136-160)
# =============================================================================

[Governance_Test_136_Critical_Errors]
search = index=_internal log_level=ERROR OR log_level=FATAL | stats count by component, host | where count > 10 | sort -count
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = */15 * * * *
enableSched = 1
description = Critical error monitoring - every 15 min

[Governance_Test_137_Error_Trend]
search = index=_internal log_level=ERROR | timechart span=1h count by component limit=10
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Error trend by component

[Governance_Test_138_Crash_Detection]
search = index=_internal sourcetype=splunkd "crash" OR "core dump" OR "segfault" OR "SIGSEGV" | table _time host message | sort -_time
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Detect crashes and segfaults

[Governance_Test_139_Disk_Space_Warnings]
search = index=_internal sourcetype=splunkd "disk" "space" ("low" OR "full" OR "warning") | stats count by host | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 * * * *
enableSched = 1
description = Disk space warning monitor

[Governance_Test_140_Memory_Warnings]
search = index=_internal sourcetype=splunkd "memory" ("low" OR "exceeded" OR "limit") | stats count by host, component | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Memory warning monitor

[Governance_Test_141_Queue_Blocked_Events]
search = index=_internal sourcetype=splunkd component=Metrics group=queue blocked=true | stats count by name, host | sort -count
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = */10 * * * *
enableSched = 1
description = Blocked queue detection

[Governance_Test_142_TCP_Input_Errors]
search = index=_internal sourcetype=splunkd component=TcpInputProc "error" OR "failed" OR "connection refused" | stats count by host | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = TCP input error monitor

[Governance_Test_143_Scripted_Input_Errors]
search = index=_internal sourcetype=splunkd component=ExecProcessor "error" OR "failed" OR "exit code" | stats count by host, script | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Scripted input error monitor

[Governance_Test_144_Modular_Input_Health]
search = index=_internal sourcetype=splunkd component=ModularInputs | stats count by log_level, input | where log_level="ERROR" OR log_level="WARN" | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Modular input health check

[Governance_Test_145_Alert_Action_Failures]
search = index=_internal sourcetype=scheduler alert_actions=* status=error | stats count by savedsearch_name, alert_actions | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Failed alert actions

[Governance_Test_146_KV_Store_Errors]
search = index=_internal sourcetype=splunkd component=KVStore* log_level=ERROR | stats count by host, message | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = KV Store error monitoring

[Governance_Test_147_HTTP_Input_Errors]
search = index=_internal sourcetype=splunkd component=HttpInputDataHandler log_level=ERROR | stats count by token_name, message | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = HEC input errors

[Governance_Test_148_Lookup_Definition_Errors]
search = index=_internal sourcetype=splunkd "lookup" "error" OR "failed" | stats count by host, message | where count > 5 | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Lookup definition errors

[Governance_Test_149_Index_Processor_Errors]
search = index=_internal sourcetype=splunkd component=IndexProcessor log_level=ERROR | stats count by host, message | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Index processor errors

[Governance_Test_150_Cluster_Master_Warnings]
search = index=_internal sourcetype=splunkd component=CM* log_level=WARN OR log_level=ERROR | stats count by component, message | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Cluster master warnings

[Governance_Test_151_License_Warnings]
search = index=_internal sourcetype=splunkd component=LicenseUsage log_level=WARN OR log_level=ERROR | stats count by host, message | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = License-related warnings

[Governance_Test_152_Authentication_Errors]
search = index=_internal sourcetype=splunkd component=Auth* log_level=ERROR | stats count by host, message | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Authentication errors

[Governance_Test_153_Database_Errors]
search = index=_internal sourcetype=splunkd "database" "error" OR "corrupt" | stats count by host, component | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Database-related errors

[Governance_Test_154_Splunkd_Restart_Events]
search = index=_internal sourcetype=splunkd "Splunkd starting" OR "Shutting down" | timechart span=1d count by host
dispatch.earliest_time = -7d
dispatch.latest_time = now
cron_schedule = 0 8 * * *
enableSched = 1
description = Splunkd restart events

[Governance_Test_155_File_Monitor_Errors]
search = index=_internal sourcetype=splunkd component=FileInputTracker log_level=ERROR | stats count by host, data_input | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = File monitor errors

[Governance_Test_156_Timeout_Events]
search = index=_internal sourcetype=splunkd "timeout" OR "timed out" | stats count by host, component | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Timeout event monitoring

[Governance_Test_157_Connection_Refused_Events]
search = index=_internal sourcetype=splunkd "connection refused" OR "connection reset" | stats count by host, component | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Connection refused events

[Governance_Test_158_Permission_Denied_Events]
search = index=_internal sourcetype=splunkd "permission denied" OR "access denied" | stats count by host, component | sort -count
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Permission denied events

[Governance_Test_159_Out_Of_Memory_Events]
search = index=_internal sourcetype=splunkd "out of memory" OR "OutOfMemory" OR "Cannot allocate" | stats count by host, component | sort -count
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Out of memory events

[Governance_Test_160_App_Install_Errors]
search = index=_internal sourcetype=splunkd "app" ("install" OR "update") ("error" OR "failed") | stats count by host, message | sort -count
dispatch.earliest_time = -7d
dispatch.latest_time = now
cron_schedule = 0 9 * * *
enableSched = 1
description = App installation errors

# =============================================================================
# SECTION 7: RESOURCE UTILIZATION (Searches 161-175)
# =============================================================================

[Governance_Test_161_CPU_Utilization]
search = index=_introspection sourcetype=splunk_resource_usage component=Hostwide | timechart span=5m avg(data.cpu_user_pct) as user avg(data.cpu_system_pct) as system by host
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = */30 * * * *
enableSched = 1
description = CPU utilization monitoring

[Governance_Test_162_Memory_Utilization]
search = index=_introspection sourcetype=splunk_resource_usage component=Hostwide | timechart span=5m avg(data.mem_used) as mem_used by host
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = */30 * * * *
enableSched = 1
description = Memory utilization monitoring

[Governance_Test_163_IO_Statistics]
search = index=_introspection sourcetype=splunk_resource_usage component=IOStats | stats avg(data.reads_kb_ps) as avg_reads avg(data.writes_kb_ps) as avg_writes by host
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Disk I/O statistics

[Governance_Test_164_Network_Statistics]
search = index=_introspection sourcetype=splunk_resource_usage component=NetworkIO | stats avg(data.bytes_in_kb_ps) as kb_in avg(data.bytes_out_kb_ps) as kb_out by host
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Network I/O statistics

[Governance_Test_165_Process_Resource_Usage]
search = index=_introspection sourcetype=splunk_resource_usage component=PerProcess | stats avg(data.pct_cpu) as avg_cpu avg(data.mem_used) as avg_mem by data.process | sort -avg_cpu | head 15
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Per-process resource usage

[Governance_Test_166_Swap_Usage_Monitor]
search = index=_introspection sourcetype=splunk_resource_usage component=Hostwide | stats avg(data.swap_used) as avg_swap max(data.swap_used) as max_swap by host | where max_swap > 0
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Swap memory usage

[Governance_Test_167_File_Descriptor_Usage]
search = index=_introspection sourcetype=splunk_resource_usage component=Hostwide | stats avg(data.fds_used) as avg_fds max(data.fds_used) as max_fds by host | sort -max_fds
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = File descriptor usage

[Governance_Test_168_Thread_Count_Monitor]
search = index=_introspection sourcetype=splunk_resource_usage component=PerProcess | stats avg(data.threads) as avg_threads max(data.threads) as max_threads by data.process, host | sort -max_threads
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Process thread count

[Governance_Test_169_Splunkd_Memory_Trend]
search = index=_introspection sourcetype=splunk_resource_usage component=PerProcess data.process="splunkd" | timechart span=1h avg(data.mem_used) as mem_used by host
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
description = Splunkd memory trend

[Governance_Test_170_Search_Process_Memory]
search = index=_introspection sourcetype=splunk_resource_usage component=PerProcess data.process="search" | stats avg(data.mem_used) as avg_mem max(data.mem_used) as max_mem by host | sort -max_mem
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Search process memory usage

[Governance_Test_171_Disk_Space_Trend]
search = index=_introspection sourcetype=splunk_disk_objects | timechart span=1d avg(data.capacity) as capacity avg(data.available) as available by data.mount_point
dispatch.earliest_time = -30d
dispatch.latest_time = now
cron_schedule = 0 10 * * *
enableSched = 1
description = Disk space trend

[Governance_Test_172_Load_Average_Monitor]
search = index=_introspection sourcetype=splunk_resource_usage component=Hostwide | stats avg(data.load_avg_1min) as load_1m avg(data.load_avg_5min) as load_5m avg(data.load_avg_15min) as load_15m by host | sort -load_1m
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = System load average

[Governance_Test_173_Python_Process_Usage]
search = index=_introspection sourcetype=splunk_resource_usage component=PerProcess data.process="*python*" | stats avg(data.pct_cpu) as avg_cpu avg(data.mem_used) as avg_mem by data.process, host | sort -avg_cpu
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = Python process resource usage

[Governance_Test_174_MongoDB_Process_Usage]
search = index=_introspection sourcetype=splunk_resource_usage component=PerProcess data.process="*mongod*" | stats avg(data.pct_cpu) as avg_cpu avg(data.mem_used) as avg_mem by host | sort -avg_mem
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
description = MongoDB (KVStore) resource usage

[Governance_Test_175_Resource_Utilization_Summary]
search = index=_introspection sourcetype=splunk_resource_usage component=Hostwide | stats avg(data.cpu_user_pct) as cpu avg(data.mem_used) as mem avg(data.swap_used) as swap by host | eval health=if(cpu>80 OR mem>90 OR swap>50, "warning", "healthy") | sort health
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
description = Overall resource health summary
