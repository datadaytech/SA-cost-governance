# PII Findings Collection - Stores all detected PII instances
[pii_findings]
enforceTypes = true
field._key = string
field.finding_id = string
field.timestamp = number
field.index = string
field.sourcetype = string
field.source = string
field.host = string
field.pii_type = string
field.pattern_name = string
field.field_name = string
field.sample_value = string
field.masked_value = string
field.event_count = number
field.severity = string
field.status = string
field.flagged_by = string
field.flagged_time = number
field.reviewed_by = string
field.reviewed_time = number
field.notes = string
accelerated_fields.finding_id = {"finding_id": 1}
accelerated_fields.timestamp = {"timestamp": -1}
accelerated_fields.status = {"status": 1}
accelerated_fields.pii_type = {"pii_type": 1}

# PII Whitelist Collection - Stores approved/safe PII patterns
[pii_whitelist]
enforceTypes = true
field._key = string
field.whitelist_id = string
field.pattern = string
field.pii_type = string
field.index = string
field.sourcetype = string
field.field_name = string
field.reason = string
field.added_by = string
field.added_time = number
field.expires = number
field.is_active = number
accelerated_fields.whitelist_id = {"whitelist_id": 1}
accelerated_fields.pii_type = {"pii_type": 1}

# PII Detection Patterns Collection - Custom regex patterns
[pii_patterns]
enforceTypes = true
field._key = string
field.pattern_id = string
field.pattern_name = string
field.pii_type = string
field.regex_pattern = string
field.validation_regex = string
field.description = string
field.severity = string
field.is_enabled = number
field.created_by = string
field.created_time = number
field.modified_by = string
field.modified_time = number
accelerated_fields.pattern_id = {"pattern_id": 1}
accelerated_fields.pii_type = {"pii_type": 1}

# PII Audit Log - Tracks all actions
[pii_audit_log]
enforceTypes = true
field._key = string
field.audit_id = string
field.timestamp = number
field.action = string
field.finding_id = string
field.pii_type = string
field.performed_by = string
field.old_status = string
field.new_status = string
field.details = string
field.ip_address = string
accelerated_fields.timestamp = {"timestamp": -1}
accelerated_fields.finding_id = {"finding_id": 1}

# PII Settings Collection - App configuration
[pii_settings]
enforceTypes = true
field._key = string
field.setting_name = string
field.setting_value = string
field.setting_type = string
field.description = string
field.modified_by = string
field.modified_time = number
accelerated_fields.setting_name = {"setting_name": 1}

# PII Scan History - Track scan executions
[pii_scan_history]
enforceTypes = true
field._key = string
field.scan_id = string
field.scan_start_time = number
field.scan_end_time = number
field.scan_duration = number
field.indexes_scanned = string
field.events_processed = number
field.findings_detected = number
field.scan_type = string
field.initiated_by = string
field.status = string
field.error_message = string
accelerated_fields.scan_id = {"scan_id": 1}
accelerated_fields.scan_start_time = {"scan_start_time": -1}
